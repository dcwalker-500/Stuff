#!bin/bash

function {

echo "running ($now)"
echo "run as 'sudo sh Network Security 2>&1 | tee output.log' to output the console output to a log file."
#Port security

    ufw enable
    ufw deny 23
    ufw deny 111
    ufw deny 515
    ufw deny 2049
    lsof  -i -n -P
    netstat -tulpn
    iptables -A INPUT -p tcp -s 0/0 -d 0/0 --dport 23 -j DROP
    #Block Telnet
    iptables -A INPUT -p tcp -s 0/0 -d 0/0 --dport 111 -j DROP
    #Block Sun rpc/NFS
    iptables -A INPUT -p udp -s 0/0 -d 0/0 --dport 111 -j DROP
    #Block Sun rpc/NFS
    iptables -A INPUT -p tcp -s 0/0 -d 0/0 --dport 515 -j DROP
    #Block printer port
    iptables -A INPUT -p udp -s 0/0 -d 0/0 --dport 515 -j DROP
    #Block printer port
    iptables -A INPUT -p tcp -s 0/0 -d 0/0 --dport 2049 -j DROP
    #Block NFS
    iptables -A INPUT -p udp -s 0/0 -d 0/0 --dport 2049 -j DROP
    #Block NFS
    iptables -A INPUT -p tcp -s 0/0 -d 0/0 --dport 6000:6009 -j DROP
    #Block X-Windows
    iptables -A INPUT -p tcp -s 0/0 -d 0/0 --dport 7100 -j DROP
    #Block X-Windows font server
    iptables -A INPUT -p all -s localhost  -i eth0 -j DROP
    #Deny outside packets from internet which claim to be from your loopback interface. 
    
    }
